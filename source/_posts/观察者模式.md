---
title: 观察者模式
date: 2019-04-06 20:30:11
tags: 设计模式
category: 设计模式
---

# 观察者模式

建立一种对象与对象之间的依赖关系，一个对象发生改变时将自动通知其他对象，其他对象将相应做出反应。在此，发生改变的对象称为观察目标，而被通知的对象称为观察者，一个观察目标可以对应多个观察者，而且这些观察者之间没有相互联系，可以根据需要增加和删除观察者，使得系统更易于扩展，这就是观察者模式的模式动机。

## 定义
<!--more-->
观察者模式：定义了一种一对多的依赖关系，让多个观察者对象同时监听一个对象。这个对象改变时，会通知观察者对象，使它们能够自动更新自己。

## 结构
- Subject: 目标,通常是一个接口或者抽象类，具有增删通知等方法
- ConcreteSubject: 具体目标
- Observer: 观察者，通常是一个接口或者抽象类
- ConcreteObserver: 具体观察者

## 例子

观察者的接口
~~~java
public interface Observer {
    void update();
}
~~~

被观察接口
~~~java
public interface Subject {

    void add(Observer o);
    void remove(Observer o);
    void notifyObservers();
}
~~~

具体观察者
~~~java
public class ObserverOne implements Observer{

    private Subject subject;

    public ObserverOne(Subject subject) {
        this.subject = subject;
    }

    @Override
    public void update() {

        System.out.println("subject"+ subject.toString()+" one");
    }
}
~~~

~~~java
public class ObserverTwo implements Observer{

    private Subject subject;

    public ObserverTwo(Subject subject) {
        this.subject = subject;
    }

    @Override
    public void update() {

        System.out.println("subject"+ subject.toString()+" two");
    }

}
~~~

具体被观察者
~~~java

public class ConcreteSubject implements Subject{
    private List<Observer> observers=new ArrayList<>();

    @Override
    public void add(Observer o) {
        observers.add(o);
    }

    @Override
    public void remove(Observer o) {
        observers.remove(o);
    }

    @Override
    public void notifyObservers() {
        for (Observer o:observers){
            o.update();
        }
    }
}

~~~
客户
~~~java

public class Client {

    public static void main(String[] args) {
        Subject s=new ConcreteSubject();
        Observer o1=new ObserverOne(s);
        Observer o2=new ObserverTwo(s);
        s.add(o1);
        s.add(o2);
        s.notifyObservers();

    }
}
~~~
类图：
![观察者类图](/观察者模式/Observer.png)

## 优点
- 定义了稳定的消息更新传递机制，抽象了更新接口，使得可以有各种各样不同的表示层作为具体观察者角色。
- 观察者模式在观察目标和观察者之间建立一个抽象的耦合。
- 观察者模式支持广播通信。


参考   
[https://design-patterns.readthedocs.io/zh_CN/latest/behavioral_patterns/observer.html](https://design-patterns.readthedocs.io/zh_CN/latest/behavioral_patterns/observer.html)
